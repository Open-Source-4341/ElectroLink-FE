<ng-template #notFound>
  <div class="card">
    <h2>‚ö† T√©cnico no encontrado</h2>
    <p>El proveedor que est√°s buscando no existe o ha sido eliminado.</p>
    <button class="back" (click)="goBack()">‚¨Ö Volver</button>
  </div>
</ng-template>

<!-- Contenedor principal -->
<div class="container" [ngClass]="{ 'expanded': hasSelected }" *ngIf="technician as tech; else notFound">
  <!-- Card del t√©cnico -->
  <div class="card">
    <h2>{{ tech.name }}</h2>
    <p><strong>Especialidad:</strong> {{ tech.specialty }}</p>
    <p><strong>Disponible:</strong> {{ tech.available }}</p>
    <p><strong>Distrito:</strong> {{ tech.location }}</p>
    <p><strong>Estrellas:</strong> ‚≠ê {{ tech.rating }}</p>
    <p><strong>Distancia:</strong> {{ tech.distance }}</p>
    <p><strong>Fecha:</strong> {{ tech.date }}</p>

    <!-- Descripciones (si las hay) -->
    <div *ngIf="tech.descriptions">
      <p><strong>Opiniones:</strong></p>
      <ul>
        <li *ngFor="let desc of getDescriptions()">"{{ desc }}"</li>
      </ul>
    </div>

    <!-- Rese√±as y formulario -->
    <app-review-list [technicianId]="tech.id"></app-review-list>
    <app-review-form [technicianId]="tech.id" (reviewSubmitted)="handleReviewSubmitted()"></app-review-form>

    <!-- Botones -->
    <div class="actions">
      <button class="buy" (click)="buyTechnician()">üõí Contratar</button>
      <button class="back" (click)="goBack()">‚¨Ö Volver</button>
    </div>
  </div>

  <!-- Resumen de compra -->
  <div class="summary-group" *ngIf="hasSelected">
    <div *ngIf="cancelMessage" class="cancel-message">
      {{ cancelMessage }}
    </div>

    <div class="summary" *ngFor="let selected of selectedTechnicians">
      <h3>Resumen de compra</h3>
      <p><strong>T√©cnico:</strong> {{ selected.name }}</p>
      <p><strong>Servicio:</strong> {{ selected.specialty }}</p>
      <p><strong>Duraci√≥n estimada:</strong> {{ selected.duration }}</p>
      <p><strong>Distrito:</strong> {{ selected.location }}</p>
      <p><strong>Fecha:</strong> {{ selected.date }}</p>
      <p><strong>Precio estimado:</strong> S/ {{ selected.price }}</p>
      <p><strong>M√©todo de pago:</strong> {{ selected.paymentMethod }}</p>

      <button class="confirm" (click)="confirmPurchaseTechnician()">‚úÖ Confirmar</button>
      <button class="cancel" (click)="cancelTechnician(selected)">‚ùå Cancelar</button>
    </div>
  </div>
</div>
